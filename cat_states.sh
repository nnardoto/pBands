#!/bin/bash

#########################################################################################
#                                    Nathanael N. Batista                               #
#                                      02 - Ago - 2023                                  #
#                                      Simplified pBands                                #
#########################################################################################


#########################################################################################
# RECORTA A PARTE RELEVANTE DO projwfc.out
#########################################################################################
CompleteFile=$(grep 'state #' $1 | tr -d ':#,()' | sed 's/m_j= /m_j=+/g')


#########################################################################################
# IGNORA O PRIMEIRO ARGUMENTO E LISTA TODOS OS OUTROS
#########################################################################################
ListOfArguments=$(echo ${@:2})


#########################################################################################
# APLICA OS FILTROS NA SEQUENCIA FORNECIDA
#########################################################################################
for Arg in $ListOfArguments; do
  CompleteFile=$(echo "$CompleteFile" | grep $Arg)
done

#########################################################################################
# IMPRIME CABEÇALHO DO RESULTADO
#########################################################################################
echo '---------------'
echo "List of States:"
echo '---------------'
echo ''

#########################################################################################
# IMPRIME NO FORMATO PARA O plotband.x
#########################################################################################
IFS=$'\n' byLine=($CompleteFile)

#### Lista Estados Selecionados separados por espaços simples
for i in ${byLine[@]}; do
  IFS=' ' NewI=($i)
  echo -n ${NewI[1]}' ' 
done

# Salta uma Linha Final
echo ''
echo ''
echo '---------------'
